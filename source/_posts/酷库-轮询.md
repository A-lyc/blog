---
title: 酷库-轮询
date: 2019-12-20 13:15:50
category: web
tags:
  - 酷库
---

> 轮询请求，超时重发请求
> 是项目中较为常见的需求

## promise-poller
> https://github.com/joeattardi/promise-poller
> 此库主要作用为基于 Promise 的重试解决方案
> 十分优雅的即可实现
> 也可以 “取巧” 用来当做轮询库使用

```javascript
// return Promise
promisePoller({
  /**
   *  返回 Promise 的任务函数
   *  若 reject 则会重试（可以一直 reject 实现无限轮询）
   *  直到 resolve
   **/
  taskFn,
  
  /** 重试请求间隔 **/
  interval: 500,
  
  /**
   *  失败重试次数
   *  这里设置为 Infinity 则可以实现无限重发（实现无限轮询）
   **/
  retries: 10,
  
  /** 每次请求的超时 **/
  timeout: 1000,
  
  /** 整个任务的超时 **/
  masterTimeout: 5000
});
```